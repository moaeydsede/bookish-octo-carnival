<!doctype html><html lang="ar" dir="rtl"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>الأدمن</title><link rel="stylesheet" href="styles.css"/>
<script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script></head>
<body>
<header class="topbar noPrint"><h2>لوحة الأدمن</h2>
<div class="topbarActions"><a class="link" href="sales.html">المبيعات</a><a class="link" href="warehouse.html">المخازن</a>
<button id="btnLogout" class="btnSecondary">خروج</button></div></header>
<main class="container">
<div class="card noPrint"><div class="chips">
<div class="chip active" data-tab="orders" id="tabOrders"></div>
<div class="chip" data-tab="customers" id="tabCustomers"></div>
<div class="chip" data-tab="excel" id="tabExcel"></div>
<div class="chip" data-tab="audit" id="tabAudit"></div>
</div></div>

<section id="sectionOrders">
<div class="card">
<div class="row"><div class="grow"><h3>إدارة الطلبيات</h3><div class="muted small">ضغط على عميل/طلب → تفاصيل مع تعديل/حذف.</div></div>
<input id="ordersSearch" class="grow" placeholder="بحث: اسم العميل / orderCode"/>
<button id="btnOrdersRefresh" class="btnSecondary" style="width:auto">تحديث</button></div>
<div class="chips">
<div class="chip active" data-filter="all" id="fAll"></div>
<div class="chip" data-filter="COMPLETE" id="fComplete"></div>
<div class="chip" data-filter="PARTIAL" id="fPartial"></div>
<div class="chip" data-filter="OPEN0" id="fOpen0"></div>
</div>
<div class="kpi" id="ordersKpi"></div>
<div id="ordersTable"></div>
</div></section>

<section id="sectionCustomers" style="display:none">
<div class="card">
<div class="row"><div class="grow"><h3>العملاء</h3><div class="muted small">إضافة / تعديل / حذف — وعند الضغط على العميل تظهر طلبياته.</div></div>
<input id="custSearch" class="grow" placeholder="بحث باسم العميل..."/>
<button id="btnCustRefresh" class="btnSecondary" style="width:auto">تحديث</button></div>
<div class="grid3">
<input id="customerCode" placeholder="customerCode (C001)"/><input id="customerName" placeholder="اسم العميل"/>
<input id="customerPhone" placeholder="هاتف (اختياري)"/></div>
<div class="row"><input id="customerAddress" class="grow" placeholder="عنوان (اختياري)"/>
<button id="btnSaveCustomer" style="width:auto"></button></div>
<p id="custMsg" class="msg"></p>
<div id="customersTable"></div>
</div></section>

<section id="sectionExcel" style="display:none">
<div class="card">
<h3>مركز Excel</h3>
<div class="muted small">Sheets: Customers / Products / Inventory / Orders / OrderItems</div>
<div class="row"><input id="excelFile" type="file" accept=".xlsx,.xls" class="grow"/>
<button id="btnPreview" class="btnSecondary" style="width:auto"></button>
<button id="btnApply" style="width:auto"></button>
<button id="btnExport" class="btnSecondary" style="width:auto"></button></div>
<pre id="previewBox" class="pre"></pre><p id="excelMsg" class="msg"></p>
</div></section>

<section id="sectionAudit" style="display:none">
<div class="card">
<div class="row"><div class="grow"><h3>شاشة العمليات</h3><div class="muted small">مراقبة: إنشاء/تعديل/حذف/إرسال/تسليم…</div></div>
<input id="auditSearch" class="grow" placeholder="بحث..."/>
<button id="btnAuditRefresh" class="btnSecondary" style="width:auto">تحديث</button></div>
<div id="auditTable"></div>
</div></section>

<div class="modalBack" id="modalBack"><div class="modal">
<div class="row" style="justify-content:space-between"><h3 id="modalTitle">Modal</h3>
<button id="btnModalClose" class="btnSecondary" style="width:auto">إغلاق</button></div>
<div id="modalBody"></div></div></div>
</main>
<script type="module" src="firebase.js"></script>
<script type="module" src="guard.js"></script>
<script type="module" src="utils.js"></script>
<script type="module" src="admin.js"></script>
</body></html>